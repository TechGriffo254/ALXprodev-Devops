#!/bin/bash

# Task 0: API Request Automation
# Fetch Pikachu data from Pokemon API and save to data.json

POKEMON="pikachu"
API_URL="https://pokeapi.co/api/v2/pokemon/${POKEMON}"
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"

# Make the API request
curl -s -o "${OUTPUT_FILE}" -w "%{http_code}" "${API_URL}" > /tmp/http_code.txt

HTTP_CODE=$(cat /tmp/http_code.txt)

# Check if request was successful
if [ "${HTTP_CODE}" -eq 200 ]; then
    echo "Successfully fetched data for ${POKEMON}"
else
    echo "Error: Failed to fetch data for ${POKEMON}. HTTP Code: ${HTTP_CODE}" | tee -a "${ERROR_FILE}"
    exit 1
fi

# Clean up temp file
rm -f /tmp/http_code.txt
